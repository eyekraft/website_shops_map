===========
 Shops Map 
===========

Эта документация также доступна на других языках, таких как `Английский <index.rst>`_ | *Pусский*.


Установка
=========
* Перед установкой модуля требуется предварительно установить Python-библиотеку '`geopy <https://geopy.readthedocs.io/en/latest/>`_'.

::

    $ pip install -r requirements.txt


Конфигурация
============

Для того, чтобы использовать текущую базу в качестве источника списка магазинов, необходимо сформировать локальный ключ API.

* Откройте меню ``Настройки --> Настройки API --> Пользователи API магазинов``.

* Введите URL текущего сайта, и в процессе сохранения записи будет сформирован ключ API.

* Введите этот URL и ключ API во время настройки источника сниппета карты.


Использование
=============

Для работы с данными требуется иметь доступ в качестве Менеджера Склада

* Откройте меню ``Склад --> Управление складом --> Склады``.

* Создайте склад.

* Отметьте его как Магазин, поставив соответствующую галочку.

* Заполните все необходимые данные.

* Поместите в редакторе на страницу сниппет карты магазинов.

* В настройках сниппета настройте URL и ключ API источника.

* Сохраните страницу. При правильно настроенном источнике будут отображены данные из базы.


Основные настройки
==================

В окне диалога настройки сниппета вы можете выставить следующие настройки:

* 'Цвет' определяет цвет рамки карточки магазина. Сниппет позволяет использовать в качестве источника несколько серверов Odoo. Иногда требуется различать магазины в общем списке.

* 'Метка' определяет цветную текстовую метку, расположенную перед названием магазина. Служит для тех же целей, что и цвет.

* 'Инфо' определяет тип информации, показываемую в заголовке карточки магазина. По умолчанию это расстояние от местоположения пользователя до магазина.

* 'Теги' определяет, магазины с какими тегами будут показаны сниппетом. Ввиду того, что модуль поддерживает карту Partner Google Map Snippet, он может использовать тегированных Клиентов с заполненными геокоординатами. Клиенты, доступные для Partner Google Map Snippet импортируются как магазины при установке модуля и могут быть отобраны по тегу. Текущий тег для магазинов модуля это 'shop'.


Дополнительные настройки (для админов и разработчиков)
======================================================

Некоторые настройки вы можете определить путем добавления аттрибутов к тегу ``<div>`` сниппета в редакторе QWEB.
Пример использования:

::

	<div id="shop-list-snippet-wrapper" data-id="eyekraftShopMap1512116381857" shops-on-page="6" switch-to-map="true">

* shop_ids='[<список ID записей модели eyekraft.shop>]' - позволяет показывать только список отобранных магазинов.

* lat='<значение широты для центра карты>'.

* lon='<значение долготы для центра карты>' - по умолчанию центр карты устанавливается в координаты пользователя. Эти опции фиксируют указанный центр карты.

* zoom='<значение масштаба>' - 1..9.

* client-placemark='<true/false>' - видимость маркера пользователя в центре карты.

* switch-to-map='<true/false>' - опция переключение на вкладку с картой после загрузки сниппета. Срабатывает только на больших экранах, оставляя для малых экранов отображение списка.

* shops-on-page='<количество магазинов на одну страницу>' - опция добавляет к списку кнопку "Показать больше".

* shops-on-page-mob='<количество магазинов на одну страницу для малых экранов>'.


Поддержка
=========

Пишите: it@eyekraft.ru?subject=website_shops_map
